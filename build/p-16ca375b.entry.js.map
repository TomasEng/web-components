{"version":3,"names":["internalStyleProviderCss","InternalStyleProviderStyle0","InternalStyleProvider","render","hue","this","hueWithOffset","baseColour","l","getOklch","setCssVariable","toFixed","asPercents","baseContrastColour","getOklchCode","gradientFactor","baseLowContrastColour","h","key","state","baseHue","hueOffsetInTurns","baseChroma","baseOklch","chroma","Chromator","setRelativeLuminance","baseColourLuminance","isDarkMode","BASE_COLOUR_LUMINANCE_DARK_MODE","BASE_COLOUR_LUMINANCE_LIGHT_MODE","mode","copy","baseContrastColourLuminance","getIncreasedLuminanceByContrast","DARK_MODE_BACKGROUND_LUMINANCE","HIGH_CONTRAST","getDecreasedLuminanceByContrast","LIGHT_MODE_BACKGROUND_LUMINANCE","baseLowContrastColourLuminance","LOW_CONTRAST","GRADIENT_FACTOR_DARK_MODE","GRADIENT_FACTOR_LIGHT_MODE","value","element","style","setProperty"],"sources":["src/components/internal-style-provider/internal-style-provider.css?tag=internal-style-provider&encapsulation=shadow","src/components/internal-style-provider/internal-style-provider.tsx"],"sourcesContent":[":host {\r\n  --t-base-colour: oklch(var(--t-base-colour-lightness) var(--t-base-colour-chroma) var(--t-base-colour-hue));\r\n  --t-selection-background-colour: var(--t-base-fill-colour);\r\n  --t-link-colour: var(--t-base-contrast-colour);\r\n  --t-link-visited-colour: oklch(from var(--t-base-contrast-colour) l c calc(h + 30));\r\n}\r\n\r\n","import { Component, h, Prop, Element } from '@stencil/core';\r\nimport { Chromator, Oklch } from 'chromator';\r\nimport {\r\n  BASE_COLOUR_LUMINANCE_DARK_MODE,\r\n  BASE_COLOUR_LUMINANCE_LIGHT_MODE,\r\n  DARK_MODE_BACKGROUND_LUMINANCE,\r\n  HIGH_CONTRAST,\r\n  GRADIENT_FACTOR_DARK_MODE,\r\n  GRADIENT_FACTOR_LIGHT_MODE,\r\n  LIGHT_MODE_BACKGROUND_LUMINANCE,\r\n  LOW_CONTRAST,\r\n} from '../../constants';\r\nimport { asPercents } from '../../utils/utils';\r\nimport state from '../../store';\r\nimport { getDecreasedLuminanceByContrast, getIncreasedLuminanceByContrast } from '../../utils/colourUtils';\r\n\r\n@Component({\r\n  tag: 'internal-style-provider',\r\n  styleUrl: 'internal-style-provider.css',\r\n  shadow: true,\r\n})\r\nexport class InternalStyleProvider {\r\n\r\n  @Prop() hueOffsetInTurns: number = 0;\r\n\r\n  @Element() element: HTMLElement;\r\n\r\n  render() {\r\n    const hue = this.hueWithOffset();\r\n    const baseColour = this.baseColour();\r\n    const { l } = baseColour.getOklch();\r\n    this.setCssVariable('--t-base-colour-hue', hue.toFixed() + 'deg');\r\n    this.setCssVariable('--t-base-colour-lightness', asPercents(l));\r\n    this.setCssVariable('--t-base-colour', 'oklch(var(--t-base-colour-lightness) var(--t-base-colour-chroma, 0.4) var(--t-base-colour-hue))');\r\n    this.setCssVariable('--t-base-border-colour', this.baseContrastColour().getOklchCode());\r\n    this.setCssVariable('--t-base-contrast-colour', this.baseContrastColour().getOklchCode());\r\n    this.setCssVariable('--t-base-fill-colour', this.baseContrastColour().getOklchCode());\r\n    this.setCssVariable('--t-gradient-factor', this.gradientFactor().toFixed(2));\r\n    this.setCssVariable('--t-base-low-contrast-colour', this.baseLowContrastColour().getOklchCode());\r\n    return <slot/>;\r\n  }\r\n\r\n  private hueWithOffset(): number {\r\n    return (state.baseHue + this.hueOffsetInTurns * 360) % 360;\r\n  }\r\n\r\n  private baseColour(): Chromator {\r\n    const { baseChroma } = state;\r\n    const hue = this.hueWithOffset();\r\n    const baseOklch: Oklch = { hue, chroma: baseChroma, l: 0.5 };\r\n    return new Chromator(baseOklch).setRelativeLuminance(this.baseColourLuminance(), 'oklch');\r\n  }\r\n\r\n  private baseColourLuminance(): number {\r\n    return this.isDarkMode() ? BASE_COLOUR_LUMINANCE_DARK_MODE : BASE_COLOUR_LUMINANCE_LIGHT_MODE;\r\n  }\r\n\r\n  private isDarkMode(): boolean {\r\n    return state.mode === 'dark';\r\n  }\r\n\r\n  private baseContrastColour(): Chromator {\r\n    return this.baseColour().copy().setRelativeLuminance(this.baseContrastColourLuminance(), 'oklch');\r\n  }\r\n\r\n  private baseContrastColourLuminance(): number {\r\n    return this.isDarkMode()\r\n      ? getIncreasedLuminanceByContrast(DARK_MODE_BACKGROUND_LUMINANCE, HIGH_CONTRAST)\r\n      : getDecreasedLuminanceByContrast(LIGHT_MODE_BACKGROUND_LUMINANCE, HIGH_CONTRAST);\r\n  }\r\n\r\n  private baseLowContrastColour(): Chromator {\r\n    return this.baseColour().copy().setRelativeLuminance(this.baseLowContrastColourLuminance(), 'oklch');\r\n  }\r\n\r\n  private baseLowContrastColourLuminance(): number {\r\n    return this.isDarkMode()\r\n      ? getIncreasedLuminanceByContrast(DARK_MODE_BACKGROUND_LUMINANCE, LOW_CONTRAST)\r\n      : getDecreasedLuminanceByContrast(LIGHT_MODE_BACKGROUND_LUMINANCE, LOW_CONTRAST);\r\n  }\r\n\r\n  private gradientFactor(): number {\r\n    return this.isDarkMode() ? GRADIENT_FACTOR_DARK_MODE : GRADIENT_FACTOR_LIGHT_MODE;\r\n  }\r\n\r\n  private setCssVariable(key: `--t-${string}`, value: string) {\r\n    this.element.style.setProperty(key, value);\r\n  }\r\n}\r\n"],"mappings":"4PAAA,MAAMA,EAA2B,+SACjC,MAAAC,EAAeD,E,MCoBFE,EAAqB,M,+CAEG,C,CAInC,MAAAC,GACE,MAAMC,EAAMC,KAAKC,gBACjB,MAAMC,EAAaF,KAAKE,aACxB,MAAMC,EAAEA,GAAMD,EAAWE,WACzBJ,KAAKK,eAAe,sBAAuBN,EAAIO,UAAY,OAC3DN,KAAKK,eAAe,4BAA6BE,EAAWJ,IAC5DH,KAAKK,eAAe,kBAAmB,mGACvCL,KAAKK,eAAe,yBAA0BL,KAAKQ,qBAAqBC,gBACxET,KAAKK,eAAe,2BAA4BL,KAAKQ,qBAAqBC,gBAC1ET,KAAKK,eAAe,uBAAwBL,KAAKQ,qBAAqBC,gBACtET,KAAKK,eAAe,sBAAuBL,KAAKU,iBAAiBJ,QAAQ,IACzEN,KAAKK,eAAe,+BAAgCL,KAAKW,wBAAwBF,gBACjF,OAAOG,EAAA,QAAAC,IAAA,4C,CAGD,aAAAZ,GACN,OAAQa,EAAMC,QAAUf,KAAKgB,iBAAmB,KAAO,G,CAGjD,UAAAd,GACN,MAAMe,WAAEA,GAAeH,EACvB,MAAMf,EAAMC,KAAKC,gBACjB,MAAMiB,EAAmB,CAAEnB,MAAKoB,OAAQF,EAAYd,EAAG,IACvD,OAAO,IAAIiB,YAAUF,GAAWG,qBAAqBrB,KAAKsB,sBAAuB,Q,CAG3E,mBAAAA,GACN,OAAOtB,KAAKuB,aAAeC,EAAkCC,C,CAGvD,UAAAF,GACN,OAAOT,EAAMY,OAAS,M,CAGhB,kBAAAlB,GACN,OAAOR,KAAKE,aAAayB,OAAON,qBAAqBrB,KAAK4B,8BAA+B,Q,CAGnF,2BAAAA,GACN,OAAO5B,KAAKuB,aACRM,EAAgCC,EAAgCC,GAChEC,EAAgCC,EAAiCF,E,CAG/D,qBAAApB,GACN,OAAOX,KAAKE,aAAayB,OAAON,qBAAqBrB,KAAKkC,iCAAkC,Q,CAGtF,8BAAAA,GACN,OAAOlC,KAAKuB,aACRM,EAAgCC,EAAgCK,GAChEH,EAAgCC,EAAiCE,E,CAG/D,cAAAzB,GACN,OAAOV,KAAKuB,aAAea,EAA4BC,C,CAGjD,cAAAhC,CAAeQ,EAAsByB,GAC3CtC,KAAKuC,QAAQC,MAAMC,YAAY5B,EAAKyB,E"}