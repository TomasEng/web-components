{"version":3,"names":["formatAuthor","author","forenames","forename","split","initials","map","name","charAt","join","surname","formatAuthors","authors","length","slice","formatPages","pageStart","pageEnd","undefined","toString","tSourceCss","TSourceStyle0","TSource","constructor","hostRef","this","text","defaultText","render","articleTitle","bookTitle","city","date","doi","issue","journal","publisher","retrievedDate","title","url","volume","websiteTitle","source","h","Host","key","AuthorAndYearInfo","class","ArticleTitle","WebsiteTitle","JournalInfo","pagesText","pages","PlaceAndPublisherInfo","RetrievedInfo","year","Fragment","VolumeAndIssue","href","target","dateString","monthIndex","month","day","Date","Intl","DateTimeFormat","navigator","language","format"],"sources":["src/components/t-source/t-source-utils.ts","src/components/t-source/t-source.css?tag=t-source&encapsulation=shadow","src/components/t-source/t-source.tsx"],"sourcesContent":["import { Author } from '../../types/TSourceItem';\n\nexport const formatAuthor = (author: Author): string => {\n  if (typeof author === 'string') return author;\n  const forenames = author.forename.split(' ');\n  const initials = forenames.map(name => name.charAt(0) + '.');\n  return `${initials.join(' ')} ${author.surname}`;\n}\n\nexport const formatAuthors = (authors: Author[]): string => {\n  if (authors.length === 0) return '';\n  if (authors.length === 1) return formatAuthor(authors[0]);\n  if (authors.length === 2) return authors.map(formatAuthor).join(' & ');\n  return authors.slice(0, -1).map(formatAuthor).join(', ') + ' & ' + formatAuthor(authors[authors.length - 1]);\n}\n\nexport const formatPages = (pageStart?: number, pageEnd?: number): string => {\n  if (pageStart !== undefined && pageEnd !== undefined) return pageStart === pageEnd ? pageStart.toString() : `${pageStart}-${pageEnd}`;\n  if (pageStart) return pageStart.toString();\n  if (pageEnd) return pageEnd.toString();\n  return '';\n}\n",":host {\n  display: block;\n}\n\n.journal {\n  font-style: italic;\n}\n\n.articleTitle, .websiteTitle, .webArticleTitle {\n  font-style: normal;\n}\n\n.bookTitle, .title {\n  font-style: italic;\n}\n","import { Component, Host, h, Prop, Fragment } from '@stencil/core';\nimport { TSourceItem } from '../../types/TSourceItem';\nimport { formatAuthors, formatPages } from './t-source-utils';\nimport { TSourceText } from './t-source.text';\nimport defaultText from './t-source.text';\n\n@Component({\n  tag: 't-source',\n  styleUrl: 't-source.css',\n  shadow: true,\n})\nexport class TSource {\n\n  @Prop() source: TSourceItem;\n  @Prop() text: TSourceText = defaultText;\n\n  render() {\n\n    const {\n      articleTitle,\n      authors,\n      bookTitle,\n      city,\n      date,\n      doi,\n      issue,\n      journal,\n      pageEnd,\n      pageStart,\n      publisher,\n      retrievedDate,\n      title,\n      url,\n      volume,\n      websiteTitle,\n    } = this.source || {}\n\n    return (\n      <Host>\n        <AuthorAndYearInfo authors={authors} date={date}/>\n        {title && !websiteTitle && <cite class=\"title\">{title}{'. '}</cite>}\n        {bookTitle && <cite class=\"bookTitle\">{bookTitle}{'. '}</cite>}\n        <ArticleTitle articleTitle={articleTitle} websiteTitle={websiteTitle} journal={journal}/>\n        <WebsiteTitle articleTitle={articleTitle} websiteTitle={websiteTitle}/>\n        <JournalInfo\n          doi={doi}\n          issue={issue}\n          journal={journal}\n          pageEnd={pageEnd}\n          pageStart={pageStart}\n          pagesText={this.text.pages}\n          volume={volume}\n        />\n        <PlaceAndPublisherInfo city={city} publisher={publisher}/>\n        <RetrievedInfo url={url} retrievedDate={retrievedDate}/>\n      </Host>\n    );\n  }\n}\n\ntype ArticleTitleProps = Pick<TSourceItem, 'articleTitle' | 'websiteTitle' | 'journal'>;\n\nconst ArticleTitle = ({ articleTitle, websiteTitle }: ArticleTitleProps) => {\n  if (websiteTitle) {\n    return <cite class=\"webArticleTitle\">«{articleTitle}»{'. '}</cite>;\n  } else if (articleTitle) {\n    return <cite class=\"articleTitle\">{articleTitle}{'. '}</cite>;\n  } else {\n    return null;\n  }\n};\n\ntype WebsiteTitleProps = Pick<TSourceItem, 'articleTitle' | 'websiteTitle'>;\n\nconst WebsiteTitle = ({ articleTitle, websiteTitle }: WebsiteTitleProps) => {\n  if (articleTitle && websiteTitle) {\n    return <cite class=\"websiteTitle\">I: {websiteTitle}{'. '}</cite>;\n  } else if (websiteTitle) {\n    return <cite class=\"websiteTitle\">{websiteTitle}{'. '}</cite>;\n  } else {\n    return null;\n  }\n};\n\ntype AuthorAndYearInfoProps = Pick<TSourceItem, 'authors' | 'date'>;\n\nconst AuthorAndYearInfo = ({authors, date}: AuthorAndYearInfoProps) => {\n  if (authors || date?.year) {\n    return (\n      <>\n        <span class=\"authors-time\">\n          {authors && <span class=\"authors\">{formatAuthors(authors)}</span>}\n          {authors && date?.year && ' '}\n          {date?.year && <span class=\"time\">({date.year})</span>}\n          {'.'}\n        </span>\n        {' '}\n      </>\n    );\n  }\n  return null;\n};\n\ntype JournalInfoProps = Pick<TSourceItem, 'journal' | 'volume' | 'issue' | 'pageStart' | 'pageEnd' | 'doi'> & {\n  pagesText: (pages: string) => string;\n};\n\nconst JournalInfo = ({ journal, volume, issue, pageEnd, pageStart, doi, pagesText }: JournalInfoProps) => {\n  const pages = formatPages(pageStart, pageEnd);\n  if (!journal) return null;\n  return (\n    <>\n      <span>\n        <span class=\"journal\">{journal}</span>\n        {(volume || issue) && <>{', '}<VolumeAndIssue volume={volume} issue={issue} /></>}\n        {pages && <>{', '}<span class=\"pages\">{pagesText(pages)}</span></>}\n        {doi && <>{', '}\n          <t-link href={'http://doi.org/' + doi} target='_blank'>doi:{doi}</t-link>\n        </>}\n        {'.'}\n      </span>\n      {' '}\n    </>\n  );\n};\n\nconst VolumeAndIssue = ({ volume, issue }: { volume?: number; issue?: number }) => {\n  return (\n    <span>\n      {volume && <span class=\"volume\">{volume}</span>}\n      {issue && <span class=\"issue\">({issue})</span>}\n    </span>\n  );\n};\n\ntype PlaceAndPublisherInfoProps = Pick<TSourceItem, 'city' | 'publisher'>;\n\nconst PlaceAndPublisherInfo = ({city, publisher}: PlaceAndPublisherInfoProps) => {\n  if (city || publisher) {\n    return (\n      <>\n        <span>\n          {city && <span>{city}</span>}\n          {city && publisher && ': '}\n          {publisher && <span>{publisher}</span>}\n          {'.'}\n        </span>\n        {' '}\n      </>\n    );\n  }\n  return null;\n}\n\ntype RetrievedInfoProps = Pick<TSourceItem, 'url' | 'retrievedDate'>;\n\nconst RetrievedInfo = ({retrievedDate, url}: RetrievedInfoProps) => {\n  let dateString = '';\n  if (retrievedDate && retrievedDate.year) {\n    const { year } = retrievedDate;\n    const monthIndex = retrievedDate?.month ? retrievedDate.month - 1 : 0;\n    const day = retrievedDate?.day || 1;\n    const date = new Date(year, monthIndex, day);\n    dateString = Intl.DateTimeFormat(navigator.language).format(date);\n  }\n  if (dateString && url) {\n    return <span>Lokalisert <time>{dateString}</time> på <t-link href={url} target='_blank'>{url}</t-link>.</span>\n  }\n  if (dateString) {\n    return <span>Lokalisert <time>{dateString}</time>.</span>\n  }\n  if (url) {\n    return <span>Lokalisert på <t-link href={url} target='_blank'>{url}</t-link>.</span>\n  }\n  return null;\n};\n"],"mappings":"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","ignoreList":[]}