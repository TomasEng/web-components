import{r as t,h as n,F as a,a as i,d as e}from"./p-91bd2b52.js";import{C as s}from"./p-3359d0b6.js";import"./p-b3b05428.js";const r=":host{display:block}ul{list-style-type:none;padding-left:0;margin:0 calc(-1 * var(--t-spacing-default));padding-inline-start:0}#tree-label{display:block;font-weight:bolder;margin-bottom:var(--t-spacing-in-group)}";const o=r;const l=class{constructor(n){t(this,n);this.label=undefined}async getAllItems(){await customElements.whenDefined("t-tree-item");return this.element.querySelectorAll("t-tree-item")}async getAllVisibleItems(){const t=await this.getAllItems();return(await Promise.all(Array.from(t).map((async t=>({include:await t.isVisible(),item:t}))))).filter((({include:t})=>t)).map((({item:t})=>t))}async resetTabindex(){const t=await this.getAllItems();await Promise.all(Array.from(t).map((async t=>{await t.setFocusable(false)})))}async getFocusableItems(){const t=await this.getAllItems();const n=[];await Promise.all(Array.from(t).map((async t=>{if(await t.isFocusable()){n.push(t)}})));return n}componentDidLoad(){return this.makeFirstItemFocusable()}async makeFirstItemFocusable(){this.getAllVisibleItems().then((async t=>{if(t.length>0){await this.resetTabindex();await t[0].setFocusable(true)}}))}render(){const t=this.label?{"aria-labelledby":c}:{};return n(a,null,this.label&&n("span",{key:"8b217d3bc8fa7fe580f539ddd2d683c97bc64965",id:c},this.label),n("ul",Object.assign({key:"3079723cf7705a7dfe8252414aa0b8bbd66faae7",role:"tree"},t),n("slot",{key:"27dad2d053204c63478b4b4d52378161e3c03a36"})))}get element(){return i(this)}};const c="tree-label";l.style=o;const h=":host {\n  --level: 0; /* Set by JS */\n  --indent: calc(var(--level) * var(--t-spacing-default));\n  --line-left-padding: calc(var(--indent) + calc(var(--t-spacing-default) / 2));\n  --line-width: 1px;\n  --line-colour: color-mix(in oklab, var(--t-font-colour-default), transparent);\n  --line-start-position: calc(var(--line-left-padding));\n  --line-end-position: calc(var(--line-start-position) + var(--line-width));\n  --arrow-width: 1rem;\n}\n\nt-link::part(link), t-button::part(button) {\n  align-items: center;\n  border-radius: 0;\n  box-sizing: border-box;\n  display: flex;\n  gap: var(--t-spacing-inline);\n  padding: var(--t-spacing-in-group) var(--t-spacing-default) var(--t-spacing-in-group) var(--indent);\n  width: 100%;\n}\n\nt-link:not(:has(.arrow))::part(link), t-button:not(:has(.arrow))::part(button) {\n  padding-left: calc(var(--indent) + var(--t-spacing-inline) + var(--arrow-width));\n}\n\nt-link:hover::part(link), t-button:hover::part(button) {\n  background-color: color-mix(in oklab, transparent, var(--t-colour-base-app));\n}\n\nli {\n  box-sizing: border-box;\n\n  &.expanded {\n    .arrow {\n      rotate: 90deg;\n    }\n\n    .collapsible {\n      grid-template-rows: 1fr;\n    }\n  }\n\n  &.collapsed {\n    .arrow {\n      rotate: 0deg;\n    }\n\n    .collapsible {\n      grid-template-rows: 0fr;\n\n      ul {\n        visibility: hidden;\n        padding: 0;\n      }\n    }\n  }\n\n  .collapsible {\n    overflow: hidden;\n    display: grid;\n    grid-template-rows: 1fr; /* To make height transition work */\n    transition: grid-template-rows var(--t-transition-duration-medium);\n\n    ul {\n      min-height: 0;\n      transition: visibility 1s;\n    }\n  }\n\n  .arrow {\n    flex-basis: content;\n    width: var(--arrow-width);\n    transition: rotate var(--t-transition-duration-medium), scale var(--t-transition-duration-short);\n\n    &:hover {\n      scale: 1.5;\n    }\n  }\n\n  .label {\n    flex: 1;\n    text-align: left;\n  }\n}\n\nul {\n  box-sizing: border-box;\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n  padding-inline: 0;\n  background: linear-gradient(\n    to right,\n    transparent 0,\n    transparent var(--line-start-position),\n    var(--line-colour) var(--line-start-position),\n    var(--line-colour) var(--line-end-position),\n    transparent var(--line-end-position)\n  );\n}\n";const d=h;const u=class{constructor(n){t(this,n);this.labelClick=e(this,"labelClick",7);this.label=undefined;this.href=null;this.expanded=false;this.hasChildren=false}async isExpanded(){await customElements.whenDefined("t-tree-item");return this.expanded}async isVisible(){const t=await this.isTopLevel();if(t){return true}else{const t=this.element.parentElement;const n=await t.isVisible();if(!n)return false;return await t.isExpanded()}}async isFocusable(){await customElements.whenDefined("t-link-or-button");return this.linkOrButton.focusable}async isTopLevel(){await customElements.whenDefined("t-tree-item");return this.element.parentElement.tagName==="T-TREE"}async getLevel(){const t=await this.isTopLevel();if(t)return 1;const n=this.element.parentElement;const a=await n.getLevel();return a+1}async focusOnLink(){await Promise.all([customElements.whenDefined("t-link-or-button"),customElements.whenDefined("t-tree-item")]);await this.linkOrButton.focusOnElement()}async getNextVisibleItem(){const t=await this.getRoot();const n=await t.getAllVisibleItems();const a=Array.from(n).indexOf(this.element);const i=a+1;return n[i]||null}async getPreviousVisibleItem(){const t=await this.getRoot();const n=await t.getAllVisibleItems();const a=Array.from(n).indexOf(this.element);const i=a-1;return n[i]||null}async getLastVisibleSubItem(){await customElements.whenDefined("t-tree-item");const t=await this.getVisibleSubItems();if(t.length>0){return t[t.length-1]}else{return null}}async getVisibleSubItems(){await customElements.whenDefined("t-tree-item");if(this.expanded&&this.hasChildren){return Array.from(this.subItems).filter((async t=>await t.isVisible()))}else{return[]}}async getSubItems(){await customElements.whenDefined("t-tree-item");return this.subItems}async setFocusable(t){await customElements.whenDefined("t-link-or-button");return this.linkOrButton.focusable=t}async getRoot(){await customElements.whenDefined("t-tree");return this.element.closest("t-tree")}get linkOrButton(){return this.element.shadowRoot.querySelector("t-link-or-button")}get subItems(){return this.element.querySelectorAll("t-tree-item")}close(){this.expanded=false}open(){this.expanded=true}toggleExpanded(){this.expanded=!this.expanded}componentDidRender(){customElements.whenDefined("t-tree-item").then((()=>{this.hasChildren=this.element.querySelector("t-tree-item")!==null;this.getLevel().then((t=>{this.element.style.setProperty("--level",t.toString())}))}))}async handleKeyDown(t){switch(t.key){case"ArrowRight":t.preventDefault();await this.handleArrowRight();break;case"ArrowLeft":t.preventDefault();await this.handleArrowLeft();break;case"ArrowUp":t.preventDefault();await this.handleArrowUp();break;case"ArrowDown":t.preventDefault();await this.handleArrowDown();break;case"Home":t.preventDefault();await this.handleHome();break;case"End":t.preventDefault();await this.handleEnd();break}}async handleArrowRight(){if(this.hasChildren){if(this.expanded){await this.moveFocusDown()}else{this.open()}}}async handleArrowLeft(){if(this.hasChildren&&this.expanded){this.close()}else{const t=await this.isTopLevel();if(!t)await this.moveFocusToParent()}}async handleArrowUp(){await this.moveFocusUp()}async handleArrowDown(){await this.moveFocusDown()}async handleHome(){await this.moveFocusToStart()}async handleEnd(){await this.moveFocusToEnd()}async moveFocusUp(){const t=await this.getPreviousVisibleItem();if(t){await this.setFocusable(false);await t.setFocusable(true);await t.focusOnLink()}}async moveFocusDown(){const t=await this.getNextVisibleItem();if(t){await this.setFocusable(false);await t.setFocusable(true);await t.focusOnLink()}}async moveFocusToParent(){const t=await this.isTopLevel();if(t)return;const n=this.element.parentElement;await this.setFocusable(false);await n.setFocusable(true);await n.focusOnLink()}async moveFocusToStart(){const t=await this.getRoot();const n=await t.getAllVisibleItems();const a=n[0];await this.setFocusable(false);await a.setFocusable(true);await a.focusOnLink()}async moveFocusToEnd(){const t=await this.getRoot();const n=await t.getAllVisibleItems();const a=n[n.length-1];await this.setFocusable(false);await a.setFocusable(true);await a.focusOnLink()}async handleClick(t){if(this.hasChildren){const t=await this.getRoot();await t.resetTabindex();await this.setFocusable(true)}this.labelClick.emit(t)}render(){const t=this.expanded?"expanded":"collapsed";const a=this.hasChildren?"withChildren":"withoutChildren";return n("li",{key:"f7402568818c5df73ff9598cb5d0ea6bfd351080","aria-expanded":this.expanded?"true":"false",class:t+" "+a,role:"treeitem",title:this.label},this.renderLink(),this.hasChildren&&n("div",{key:"d6e220e3cb06521b226b06e1934fb52ee317189c",class:"collapsible"},n("ul",{key:"e2eaac6a0d828d74838a1acea846fc8131037f2d",role:"group"},n("slot",{key:"1c846c2cff06e8368e18dcbcb1b542852aa05015"}))))}renderLink(){return n("t-link-or-button",{href:this.href,onElementClick:t=>this.handleClick(t.detail),onKeyDown:t=>this.handleKeyDown(t)},this.renderLabel())}renderLabel(){return n(a,null,this.hasChildren&&n(s,{class:"arrow",fill:true,onClick:t=>this.handleArrowClick(t)}),n("span",{class:"label"},this.label))}handleArrowClick(t){t.preventDefault();t.stopPropagation();this.toggleExpanded()}get element(){return i(this)}};u.style=d;export{l as t_tree,u as t_tree_item};
//# sourceMappingURL=p-cbd17182.entry.js.map