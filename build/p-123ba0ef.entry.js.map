{"version":3,"names":["tTableOfContentsCss","TTableOfContentsStyle0","TTableOfContents","tree","this","element","shadowRoot","querySelector","componentDidLoad","headings","findHeadings","then","headingElements","forEach","headingElement","index","id","level","text","textContent","parentIndex","findLastIndex","heading","push","item","document","createElement","label","href","addEventListener","scrollIntoView","treeItem","parentElement","appendChild","async","customElements","whenDefined","makeFirstItemFocusable","render","h","key","Array","from","querySelectorAll"],"sources":["src/components/t-table-of-contents/t-table-of-contents.css?tag=t-table-of-contents&encapsulation=shadow","src/components/t-table-of-contents/t-table-of-contents.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import { Component, Element, h, Prop } from '@stencil/core';\nimport { findLastIndex } from '../../utils/arrayUtils';\n\ntype Heading = {\n  id?: string;\n  element: HTMLTHeadingElement;\n  level: number;\n  parentIndex: number;\n  text: string;\n  treeItem?: HTMLTTreeItemElement;\n}\n\n@Component({\n  tag: 't-table-of-contents',\n  styleUrl: 't-table-of-contents.css',\n  shadow: true,\n})\nexport class TTableOfContents {\n\n  @Element() element: HTMLTTableOfContentsElement;\n\n  @Prop() label?: string;\n\n  get tree(): HTMLTTreeElement {\n    return this.element.shadowRoot.querySelector('t-tree');\n  }\n\n  componentDidLoad() {\n    const headings: Heading[] = [];\n    this.findHeadings().then(headingElements => {\n      headingElements.forEach((headingElement, index) => {\n        const id = headingElement.id || null;\n        const level = headingElement.level;\n        const text = headingElement.textContent;\n        const parentIndex = findLastIndex(headings, heading => heading.level < level);\n        const heading: Heading = { id, level, parentIndex, text, element: headingElement };\n        headings.push(heading);\n      });\n      headings.forEach(heading => {\n        const { id, text, parentIndex, element, level } = heading;\n        const item = document.createElement('t-tree-item');\n        item.label = text;\n        if (id) {\n          item.href = `#${id}`;\n        } else {\n          item.addEventListener('labelClick', () => {\n            element.scrollIntoView();\n          });\n        }\n        heading.treeItem = item;\n        if (level > 1) {\n          const parentElement = level < 3 ? this.tree : headings[parentIndex].treeItem;\n          parentElement.appendChild(item);\n        }\n      });\n    }).then(async () => {\n      await customElements.whenDefined('t-tree');\n      await this.tree.makeFirstItemFocusable();\n    });\n  }\n\n  render() {\n    return <t-tree label={this.label}/>;\n  }\n\n  private async findHeadings() {\n    await customElements.whenDefined('t-heading');\n    return Array.from(document.querySelectorAll('t-heading'));\n  }\n}\n"],"mappings":"sFAAA,MAAMA,EAAsB,uBAC5B,MAAAC,EAAeD,E,MCgBFE,EAAgB,M,8CAM3B,QAAIC,GACF,OAAOC,KAAKC,QAAQC,WAAWC,cAAc,S,CAG/C,gBAAAC,GACE,MAAMC,EAAsB,GAC5BL,KAAKM,eAAeC,MAAKC,IACvBA,EAAgBC,SAAQ,CAACC,EAAgBC,KACvC,MAAMC,EAAKF,EAAeE,IAAM,KAChC,MAAMC,EAAQH,EAAeG,MAC7B,MAAMC,EAAOJ,EAAeK,YAC5B,MAAMC,EAAcC,EAAcZ,GAAUa,GAAWA,EAAQL,MAAQA,IACvE,MAAMK,EAAmB,CAAEN,KAAIC,QAAOG,cAAaF,OAAMb,QAASS,GAClEL,EAASc,KAAKD,EAAQ,IAExBb,EAASI,SAAQS,IACf,MAAMN,GAAEA,EAAEE,KAAEA,EAAIE,YAAEA,EAAWf,QAAEA,EAAOY,MAAEA,GAAUK,EAClD,MAAME,EAAOC,SAASC,cAAc,eACpCF,EAAKG,MAAQT,EACb,GAAIF,EAAI,CACNQ,EAAKI,KAAO,IAAIZ,G,KACX,CACLQ,EAAKK,iBAAiB,cAAc,KAClCxB,EAAQyB,gBAAgB,G,CAG5BR,EAAQS,SAAWP,EACnB,GAAIP,EAAQ,EAAG,CACb,MAAMe,EAAgBf,EAAQ,EAAIb,KAAKD,KAAOM,EAASW,GAAaW,SACpEC,EAAcC,YAAYT,E,IAE5B,IACDb,MAAKuB,gBACAC,eAAeC,YAAY,gBAC3BhC,KAAKD,KAAKkC,wBAAwB,G,CAI5C,MAAAC,GACE,OAAOC,EAAA,UAAAC,IAAA,2CAAQb,MAAOvB,KAAKuB,O,CAGrB,kBAAMjB,SACNyB,eAAeC,YAAY,aACjC,OAAOK,MAAMC,KAAKjB,SAASkB,iBAAiB,a","ignoreList":[]}