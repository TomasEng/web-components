{"version":3,"names":["formatAuthor","author","forenames","forename","split","initials","map","name","charAt","join","surname","formatAuthors","authors","length","slice","formatPages","pageStart","pageEnd","undefined","toString","tSourceCss","TSourceStyle0","TSource","defaultText","render","articleTitle","bookTitle","city","date","doi","issue","journal","publisher","retrievedDate","title","url","volume","this","source","h","Host","key","AuthorAndYearInfo","class","JournalInfo","pagesText","text","pages","PlaceAndPublisherInfo","RetrievedInfo","year","Fragment","VolumeAndIssue","href","target","dateString","monthIndex","month","day","Date","Intl","DateTimeFormat","navigator","language","format"],"sources":["src/components/t-source/t-source-utils.ts","src/components/t-source/t-source.css?tag=t-source&encapsulation=shadow","src/components/t-source/t-source.tsx"],"sourcesContent":["import { Author } from '../../types/TSourceItem';\n\nexport const formatAuthor = (author: Author): string => {\n  if (typeof author === 'string') return author;\n  const forenames = author.forename.split(' ');\n  const initials = forenames.map(name => name.charAt(0) + '.');\n  return `${initials.join(' ')} ${author.surname}`;\n}\n\nexport const formatAuthors = (authors: Author[]): string => {\n  if (authors.length === 0) return '';\n  if (authors.length === 1) return formatAuthor(authors[0]);\n  if (authors.length === 2) return authors.map(formatAuthor).join(' & ');\n  return authors.slice(0, -1).map(formatAuthor).join(', ') + ' & ' + formatAuthor(authors[authors.length - 1]);\n}\n\nexport const formatPages = (pageStart?: number, pageEnd?: number): string => {\n  if (pageStart !== undefined && pageEnd !== undefined) return pageStart === pageEnd ? pageStart.toString() : `${pageStart}-${pageEnd}`;\n  if (pageStart) return pageStart.toString();\n  if (pageEnd) return pageEnd.toString();\n  return '';\n}\n",":host {\n  display: block;\n}\n\n.journal {\n  font-style: italic;\n}\n\n.articleTitle {\n  font-style: normal;\n}\n\n.bookTitle, .title {\n  font-style: italic;\n}\n","import { Component, Host, h, Prop, Fragment } from '@stencil/core';\nimport { TSourceItem } from '../../types/TSourceItem';\nimport { formatAuthors, formatPages } from './t-source-utils';\nimport { TSourceText } from './t-source.text';\nimport defaultText from './t-source.text';\n\n@Component({\n  tag: 't-source',\n  styleUrl: 't-source.css',\n  shadow: true,\n})\nexport class TSource {\n\n  @Prop() source: TSourceItem;\n  @Prop() text: TSourceText = defaultText;\n\n  render() {\n\n    const {\n      articleTitle,\n      authors,\n      bookTitle,\n      city,\n      date,\n      doi,\n      issue,\n      journal,\n      pageEnd,\n      pageStart,\n      publisher,\n      retrievedDate,\n      title,\n      url,\n      volume,\n    } = this.source || {}\n\n    return (\n      <Host>\n        <AuthorAndYearInfo authors={authors} date={date}/>\n        {title && <cite class=\"title\">{title}{'. '}</cite>}\n        {bookTitle && <cite class=\"bookTitle\">{bookTitle}{'. '}</cite>}\n        {articleTitle && <cite class=\"articleTitle\">{articleTitle}{'. '}</cite>}\n        <JournalInfo\n          doi={doi}\n          issue={issue}\n          journal={journal}\n          pageEnd={pageEnd}\n          pageStart={pageStart}\n          pagesText={this.text.pages}\n          volume={volume}\n        />\n        <PlaceAndPublisherInfo city={city} publisher={publisher}/>\n        <RetrievedInfo url={url} retrievedDate={retrievedDate}/>\n      </Host>\n    );\n  }\n}\n\ntype AuthorAndYearInfoProps = Pick<TSourceItem, 'authors' | 'date'>;\n\nconst AuthorAndYearInfo = ({authors, date}: AuthorAndYearInfoProps) => {\n  if (authors || date?.year) {\n    return (\n      <>\n        <span class=\"authors-time\">\n          {authors && <span class=\"authors\">{formatAuthors(authors)}</span>}\n          {authors && date?.year && ' '}\n          {date?.year && <span class=\"time\">({date.year})</span>}\n          {'.'}\n        </span>\n        {' '}\n      </>\n    );\n  }\n  return null;\n}\n\ntype JournalInfoProps = Pick<TSourceItem, 'journal' | 'volume' | 'issue' | 'pageStart' | 'pageEnd' | 'doi'> & {\n  pagesText: (pages: string) => string;\n};\n\nconst JournalInfo = ({ journal, volume, issue, pageEnd, pageStart, doi, pagesText }: JournalInfoProps) => {\n  const pages = formatPages(pageStart, pageEnd);\n  if (!journal) return null;\n  return (\n    <>\n      <span>\n        <span class=\"journal\">{journal}</span>\n        {(volume || issue) && <>{', '}<VolumeAndIssue volume={volume} issue={issue} /></>}\n        {pages && <>{', '}<span class=\"pages\">{pagesText(pages)}</span></>}\n        {doi && <>{', '}\n          <t-link href={'http://doi.org/' + doi} target='_blank'>doi:{doi}</t-link>\n        </>}\n        {'.'}\n      </span>\n      {' '}\n    </>\n  );\n};\n\nconst VolumeAndIssue = ({ volume, issue }: { volume?: number; issue?: number }) => {\n  return (\n    <span>\n      {volume && <span class=\"volume\">{volume}</span>}\n      {issue && <span class=\"issue\">({issue})</span>}\n    </span>\n  );\n};\n\ntype PlaceAndPublisherInfoProps = Pick<TSourceItem, 'city' | 'publisher'>;\n\nconst PlaceAndPublisherInfo = ({city, publisher}: PlaceAndPublisherInfoProps) => {\n  if (city || publisher) {\n    return (\n      <>\n        <span>\n          {city && <span>{city}</span>}\n          {city && publisher && ': '}\n          {publisher && <span>{publisher}</span>}\n          {'.'}\n        </span>\n        {' '}\n      </>\n    );\n  }\n  return null;\n}\n\ntype RetrievedInfoProps = Pick<TSourceItem, 'url' | 'retrievedDate'>;\n\nconst RetrievedInfo = ({retrievedDate, url}: RetrievedInfoProps) => {\n  let dateString = '';\n  if (retrievedDate && retrievedDate.year) {\n    const { year } = retrievedDate;\n    const monthIndex = retrievedDate?.month ? retrievedDate.month - 1 : 0;\n    const day = retrievedDate?.day || 1;\n    const date = new Date(year, monthIndex, day);\n    dateString = Intl.DateTimeFormat(navigator.language).format(date);\n  }\n  if (dateString && url) {\n    return <span>Lokalisert <time>{dateString}</time> på <t-link href={url} target='_blank'>{url}</t-link>.</span>\n  }\n  if (dateString) {\n    return <span>Lokalisert <time>{dateString}</time>.</span>\n  }\n  if (url) {\n    return <span>Lokalisert på <t-link href={url} target='_blank'>{url}</t-link>.</span>\n  }\n  return null;\n};\n"],"mappings":"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"}