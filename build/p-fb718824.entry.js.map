{"version":3,"names":["formatAuthor","author","forenames","forename","split","initials","map","name","charAt","join","surname","formatAuthors","authors","length","slice","formatPages","pageStart","pageEnd","undefined","toString","tSourceCss","TSourceStyle0","TSource","defaultText","render","articleTitle","bookTitle","city","date","doi","issue","journal","publisher","retrievedDate","title","url","volume","websiteTitle","this","source","h","Host","key","AuthorAndYearInfo","class","ArticleTitle","WebsiteTitle","JournalInfo","pagesText","text","pages","PlaceAndPublisherInfo","RetrievedInfo","year","Fragment","VolumeAndIssue","href","target","dateString","monthIndex","month","day","Date","Intl","DateTimeFormat","navigator","language","format"],"sources":["src/components/t-source/t-source-utils.ts","src/components/t-source/t-source.css?tag=t-source&encapsulation=shadow","src/components/t-source/t-source.tsx"],"sourcesContent":["import { Author } from '../../types/TSourceItem';\n\nexport const formatAuthor = (author: Author): string => {\n  if (typeof author === 'string') return author;\n  const forenames = author.forename.split(' ');\n  const initials = forenames.map(name => name.charAt(0) + '.');\n  return `${initials.join(' ')} ${author.surname}`;\n}\n\nexport const formatAuthors = (authors: Author[]): string => {\n  if (authors.length === 0) return '';\n  if (authors.length === 1) return formatAuthor(authors[0]);\n  if (authors.length === 2) return authors.map(formatAuthor).join(' & ');\n  return authors.slice(0, -1).map(formatAuthor).join(', ') + ' & ' + formatAuthor(authors[authors.length - 1]);\n}\n\nexport const formatPages = (pageStart?: number, pageEnd?: number): string => {\n  if (pageStart !== undefined && pageEnd !== undefined) return pageStart === pageEnd ? pageStart.toString() : `${pageStart}-${pageEnd}`;\n  if (pageStart) return pageStart.toString();\n  if (pageEnd) return pageEnd.toString();\n  return '';\n}\n",":host {\n  display: block;\n}\n\n.journal {\n  font-style: italic;\n}\n\n.articleTitle, .websiteTitle, .webArticleTitle {\n  font-style: normal;\n}\n\n.bookTitle, .title {\n  font-style: italic;\n}\n","import { Component, Host, h, Prop, Fragment } from '@stencil/core';\nimport { TSourceItem } from '../../types/TSourceItem';\nimport { formatAuthors, formatPages } from './t-source-utils';\nimport { TSourceText } from './t-source.text';\nimport defaultText from './t-source.text';\n\n@Component({\n  tag: 't-source',\n  styleUrl: 't-source.css',\n  shadow: true,\n})\nexport class TSource {\n\n  @Prop() source: TSourceItem;\n  @Prop() text: TSourceText = defaultText;\n\n  render() {\n\n    const {\n      articleTitle,\n      authors,\n      bookTitle,\n      city,\n      date,\n      doi,\n      issue,\n      journal,\n      pageEnd,\n      pageStart,\n      publisher,\n      retrievedDate,\n      title,\n      url,\n      volume,\n      websiteTitle,\n    } = this.source || {}\n\n    return (\n      <Host>\n        <AuthorAndYearInfo authors={authors} date={date}/>\n        {title && !websiteTitle && <cite class=\"title\">{title}{'. '}</cite>}\n        {bookTitle && <cite class=\"bookTitle\">{bookTitle}{'. '}</cite>}\n        <ArticleTitle articleTitle={articleTitle} websiteTitle={websiteTitle} journal={journal}/>\n        <WebsiteTitle articleTitle={articleTitle} websiteTitle={websiteTitle}/>\n        <JournalInfo\n          doi={doi}\n          issue={issue}\n          journal={journal}\n          pageEnd={pageEnd}\n          pageStart={pageStart}\n          pagesText={this.text.pages}\n          volume={volume}\n        />\n        <PlaceAndPublisherInfo city={city} publisher={publisher}/>\n        <RetrievedInfo url={url} retrievedDate={retrievedDate}/>\n      </Host>\n    );\n  }\n}\n\ntype ArticleTitleProps = Pick<TSourceItem, 'articleTitle' | 'websiteTitle' | 'journal'>;\n\nconst ArticleTitle = ({ articleTitle, websiteTitle }: ArticleTitleProps) => {\n  if (websiteTitle) {\n    return <cite class=\"webArticleTitle\">«{articleTitle}»{'. '}</cite>;\n  } else if (articleTitle) {\n    return <cite class=\"articleTitle\">{articleTitle}{'. '}</cite>;\n  } else {\n    return null;\n  }\n};\n\ntype WebsiteTitleProps = Pick<TSourceItem, 'articleTitle' | 'websiteTitle'>;\n\nconst WebsiteTitle = ({ articleTitle, websiteTitle }: WebsiteTitleProps) => {\n  if (articleTitle && websiteTitle) {\n    return <cite class=\"websiteTitle\">I: {websiteTitle}{'. '}</cite>;\n  } else if (websiteTitle) {\n    return <cite class=\"websiteTitle\">{websiteTitle}{'. '}</cite>;\n  } else {\n    return null;\n  }\n};\n\ntype AuthorAndYearInfoProps = Pick<TSourceItem, 'authors' | 'date'>;\n\nconst AuthorAndYearInfo = ({authors, date}: AuthorAndYearInfoProps) => {\n  if (authors || date?.year) {\n    return (\n      <>\n        <span class=\"authors-time\">\n          {authors && <span class=\"authors\">{formatAuthors(authors)}</span>}\n          {authors && date?.year && ' '}\n          {date?.year && <span class=\"time\">({date.year})</span>}\n          {'.'}\n        </span>\n        {' '}\n      </>\n    );\n  }\n  return null;\n};\n\ntype JournalInfoProps = Pick<TSourceItem, 'journal' | 'volume' | 'issue' | 'pageStart' | 'pageEnd' | 'doi'> & {\n  pagesText: (pages: string) => string;\n};\n\nconst JournalInfo = ({ journal, volume, issue, pageEnd, pageStart, doi, pagesText }: JournalInfoProps) => {\n  const pages = formatPages(pageStart, pageEnd);\n  if (!journal) return null;\n  return (\n    <>\n      <span>\n        <span class=\"journal\">{journal}</span>\n        {(volume || issue) && <>{', '}<VolumeAndIssue volume={volume} issue={issue} /></>}\n        {pages && <>{', '}<span class=\"pages\">{pagesText(pages)}</span></>}\n        {doi && <>{', '}\n          <t-link href={'http://doi.org/' + doi} target='_blank'>doi:{doi}</t-link>\n        </>}\n        {'.'}\n      </span>\n      {' '}\n    </>\n  );\n};\n\nconst VolumeAndIssue = ({ volume, issue }: { volume?: number; issue?: number }) => {\n  return (\n    <span>\n      {volume && <span class=\"volume\">{volume}</span>}\n      {issue && <span class=\"issue\">({issue})</span>}\n    </span>\n  );\n};\n\ntype PlaceAndPublisherInfoProps = Pick<TSourceItem, 'city' | 'publisher'>;\n\nconst PlaceAndPublisherInfo = ({city, publisher}: PlaceAndPublisherInfoProps) => {\n  if (city || publisher) {\n    return (\n      <>\n        <span>\n          {city && <span>{city}</span>}\n          {city && publisher && ': '}\n          {publisher && <span>{publisher}</span>}\n          {'.'}\n        </span>\n        {' '}\n      </>\n    );\n  }\n  return null;\n}\n\ntype RetrievedInfoProps = Pick<TSourceItem, 'url' | 'retrievedDate'>;\n\nconst RetrievedInfo = ({retrievedDate, url}: RetrievedInfoProps) => {\n  let dateString = '';\n  if (retrievedDate && retrievedDate.year) {\n    const { year } = retrievedDate;\n    const monthIndex = retrievedDate?.month ? retrievedDate.month - 1 : 0;\n    const day = retrievedDate?.day || 1;\n    const date = new Date(year, monthIndex, day);\n    dateString = Intl.DateTimeFormat(navigator.language).format(date);\n  }\n  if (dateString && url) {\n    return <span>Lokalisert <time>{dateString}</time> på <t-link href={url} target='_blank'>{url}</t-link>.</span>\n  }\n  if (dateString) {\n    return <span>Lokalisert <time>{dateString}</time>.</span>\n  }\n  if (url) {\n    return <span>Lokalisert på <t-link href={url} target='_blank'>{url}</t-link>.</span>\n  }\n  return null;\n};\n"],"mappings":"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","ignoreList":[]}