import{g as e,f as t}from"./p-91bd2b52.js";const s=(e,t,s)=>{const o=e.get(t);if(!o){e.set(t,[s])}else if(!o.includes(s)){o.push(s)}};const o=(e,t)=>{let s;return(...o)=>{if(s){clearTimeout(s)}s=setTimeout((()=>{s=0;e(...o)}),t)}};const n=e=>!("isConnected"in e)||e.isConnected;const r=o((e=>{for(let t of e.keys()){e.set(t,e.get(t).filter(n))}}),2e3);const c=()=>{if(typeof e!=="function"){return{}}const o=new Map;return{dispose:()=>o.clear(),get:t=>{const n=e();if(n){s(o,t,n)}},set:e=>{const s=o.get(e);if(s){o.set(e,s.filter(t))}r(o)},reset:()=>{o.forEach((e=>e.forEach(t)));r(o)}}};const i=e=>typeof e==="function"?e():e;const f=(e,t=((e,t)=>e!==t))=>{const s=i(e);let o=new Map(Object.entries(s!==null&&s!==void 0?s:{}));const n={dispose:[],get:[],set:[],reset:[]};const r=()=>{var t;o=new Map(Object.entries((t=i(e))!==null&&t!==void 0?t:{}));n.reset.forEach((e=>e()))};const c=()=>{n.dispose.forEach((e=>e()));r()};const f=e=>{n.get.forEach((t=>t(e)));return o.get(e)};const u=(e,s)=>{const r=o.get(e);if(t(s,r,e)){o.set(e,s);n.set.forEach((t=>t(e,s,r)))}};const d=typeof Proxy==="undefined"?{}:new Proxy(s,{get(e,t){return f(t)},ownKeys(e){return Array.from(o.keys())},getOwnPropertyDescriptor(){return{enumerable:true,configurable:true}},has(e,t){return o.has(t)},set(e,t,s){u(t,s);return true}});const l=(e,t)=>{n[e].push(t);return()=>{a(n[e],t)}};const p=(t,s)=>{const o=l("set",((e,o)=>{if(e===t){s(o)}}));const n=l("reset",(()=>s(i(e)[t])));return()=>{o();n()}};const g=(...e)=>{const t=e.reduce(((e,t)=>{if(t.set){e.push(l("set",t.set))}if(t.get){e.push(l("get",t.get))}if(t.reset){e.push(l("reset",t.reset))}if(t.dispose){e.push(l("dispose",t.dispose))}return e}),[]);return()=>t.forEach((e=>e()))};const m=e=>{const t=o.get(e);n.set.forEach((s=>s(e,t,t)))};return{state:d,get:f,set:u,on:l,onChange:p,use:g,dispose:c,reset:r,forceUpdate:m}};const a=(e,t)=>{const s=e.indexOf(t);if(s>=0){e[s]=e[e.length-1];e.length--}};const u=(e,t)=>{const s=f(e,t);s.use(c());return s};const d=()=>{const e=w();if(e)return e;else return l()};const l=()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";const p="t-mode";const g=e=>{localStorage.setItem(p,e)};const m=()=>{localStorage.removeItem(p)};const w=()=>localStorage.getItem(p);const{state:y}=u({selectedMode:w()||"system",mode:d(),baseHue:160,baseChroma:.4,contrast:1,hueOffsetVisitedLink:30,hueOffsetCode:180});window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{if(y.selectedMode==="system"){y.mode=e.matches?"dark":"light"}}));window.addEventListener("storage",(e=>{if(e.key==="t-mode"){y.mode=d()}}));const h=e=>{y.selectedMode=e;if(e==="system"){y.mode=l();m()}else{y.mode=e;g(e)}};export{h as a,y as s};
//# sourceMappingURL=p-adeb63a3.js.map