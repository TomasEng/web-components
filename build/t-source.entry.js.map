{"file":"t-source.entry.esm.js","mappings":"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","names":[],"sources":["src/components/t-source/t-source-utils.ts","src/components/t-source/t-source.css?tag=t-source&encapsulation=shadow","src/components/t-source/t-source.tsx"],"sourcesContent":["import { Author } from '../../types/TSourceItem';\n\nexport const formatAuthor = (author: Author): string => {\n  if (typeof author === 'string') return author;\n  const forenames = author.forename.split(' ');\n  const initials = forenames.map(name => name.charAt(0) + '.');\n  return `${initials.join(' ')} ${author.surname}`;\n}\n\nexport const formatAuthors = (authors: Author[]): string => {\n  if (authors.length === 0) return '';\n  if (authors.length === 1) return formatAuthor(authors[0]);\n  if (authors.length === 2) return authors.map(formatAuthor).join(' & ');\n  return authors.slice(0, -1).map(formatAuthor).join(', ') + ' & ' + formatAuthor(authors[authors.length - 1]);\n}\n\nexport const formatPages = (pageStart?: number, pageEnd?: number): string => {\n  if (pageStart !== undefined && pageEnd !== undefined) return pageStart === pageEnd ? pageStart.toString() : `${pageStart}-${pageEnd}`;\n  if (pageStart) return pageStart.toString();\n  if (pageEnd) return pageEnd.toString();\n  return '';\n}\n",":host {\n  display: block;\n}\n\n.journal {\n  font-style: italic;\n}\n\n.articleTitle {\n  font-style: normal;\n}\n\n.bookTitle, .title {\n  font-style: italic;\n}\n","import { Component, Host, h, Prop, Fragment } from '@stencil/core';\nimport { TSourceItem } from '../../types/TSourceItem';\nimport { formatAuthors, formatPages } from './t-source-utils';\n\n@Component({\n  tag: 't-source',\n  styleUrl: 't-source.css',\n  shadow: true,\n})\nexport class TSource {\n\n  @Prop() source: TSourceItem;\n  @Prop() pagesText: (pages: string) => string = pages => `s. ${pages}`;\n\n  render() {\n\n    const {\n      articleTitle,\n      authors,\n      bookTitle,\n      city,\n      date,\n      doi,\n      issue,\n      journal,\n      pageEnd,\n      pageStart,\n      publisher,\n      retrievedDate,\n      title,\n      url,\n      volume,\n    } = this.source || {}\n\n    return (\n      <Host>\n        <AuthorAndYearInfo authors={authors} date={date}/>\n        {title && <cite class=\"title\">{title}{'. '}</cite>}\n        {bookTitle && <cite class=\"bookTitle\">{bookTitle}{'. '}</cite>}\n        {articleTitle && <cite class=\"articleTitle\">{articleTitle}{'. '}</cite>}\n        <JournalInfo\n          doi={doi}\n          issue={issue}\n          journal={journal}\n          pageEnd={pageEnd}\n          pageStart={pageStart}\n          pagesText={this.pagesText}\n          volume={volume}\n        />\n        <PlaceAndPublisherInfo city={city} publisher={publisher}/>\n        <RetrievedInfo url={url} retrievedDate={retrievedDate}/>\n      </Host>\n    );\n  }\n}\n\ntype AuthorAndYearInfoProps = Pick<TSourceItem, 'authors' | 'date'>;\n\nconst AuthorAndYearInfo = ({authors, date}: AuthorAndYearInfoProps) => {\n  if (authors || date?.year) {\n    return (\n      <>\n        <span class=\"authors-time\">\n          {authors && <span class=\"authors\">{formatAuthors(authors)}</span>}\n          {authors && date?.year && ' '}\n          {date?.year && <span class=\"time\">({date.year})</span>}\n          {'.'}\n        </span>\n        {' '}\n      </>\n    );\n  }\n  return null;\n}\n\ntype JournalInfoProps = Pick<TSourceItem, 'journal' | 'volume' | 'issue' | 'pageStart' | 'pageEnd' | 'doi'> & {\n  pagesText: (pages: string) => string;\n};\n\nconst JournalInfo = ({ journal, volume, issue, pageEnd, pageStart, doi, pagesText }: JournalInfoProps) => {\n  const pages = formatPages(pageStart, pageEnd);\n  if (!journal) return null;\n  return (\n    <>\n      <span>\n        <span class=\"journal\">{journal}</span>\n        {(volume || issue) && <>{', '}<VolumeAndIssue volume={volume} issue={issue} /></>}\n        {pages && <>{', '}<span class=\"pages\">{pagesText(pages)}</span></>}\n        {doi && <>{', '}\n          <t-link href={'http://doi.org/' + doi} target='_blank'>doi:{doi}</t-link>\n        </>}\n        {'.'}\n      </span>\n      {' '}\n    </>\n  );\n};\n\nconst VolumeAndIssue = ({ volume, issue }: { volume?: number; issue?: number }) => {\n  return (\n    <span>\n      {volume && <span class=\"volume\">{volume}</span>}\n      {issue && <span class=\"issue\">({issue})</span>}\n    </span>\n  );\n};\n\ntype PlaceAndPublisherInfoProps = Pick<TSourceItem, 'city' | 'publisher'>;\n\nconst PlaceAndPublisherInfo = ({city, publisher}: PlaceAndPublisherInfoProps) => {\n  if (city || publisher) {\n    return (\n      <>\n        <span>\n          {city && <span>{city}</span>}\n          {city && publisher && ': '}\n          {publisher && <span>{publisher}</span>}\n          {'.'}\n        </span>\n        {' '}\n      </>\n    );\n  }\n  return null;\n}\n\ntype RetrievedInfoProps = Pick<TSourceItem, 'url' | 'retrievedDate'>;\n\nconst RetrievedInfo = ({retrievedDate, url}: RetrievedInfoProps) => {\n  let dateString = '';\n  if (retrievedDate && retrievedDate.year) {\n    const { year } = retrievedDate;\n    const monthIndex = retrievedDate?.month ? retrievedDate.month - 1 : 0;\n    const day = retrievedDate?.day || 1;\n    const date = new Date(year, monthIndex, day);\n    dateString = Intl.DateTimeFormat(navigator.language).format(date);\n  }\n  if (dateString && url) {\n    return <span>Lokalisert <time>{dateString}</time> på <t-link href={url} target='_blank'>{url}</t-link>.</span>\n  }\n  if (dateString) {\n    return <span>Lokalisert <time>{dateString}</time>.</span>\n  }\n  if (url) {\n    return <span>Lokalisert på <t-link href={url} target='_blank'>{url}</t-link>.</span>\n  }\n  return null;\n};\n"],"version":3}